<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Movies</title>
    <script src="https://unpkg.com/htmx.org"></script>
    <script src="https://unpkg.com/htmx.org/dist/ext/client-side-templates.js"></script>
    <script src="https://unpkg.com/htmx.org/dist/ext/json-enc.js"></script>
    <script src="https://unpkg.com/mustache"></script>
</head>

<body>
    <div hx-ext="client-side-templates">
        <h1>
            Movies
        </h1>

        <form id="form" hx-post="/movies" hx-ext="json-enc">
            <h2>Add a new movie</h2>
            <label for="imdb_id">IMDbId</label>
            <input id="imdb_id" type="string" name="imdb_id" placeholder="IMDbId" required>

            <label for="title">Title</label>
            <input id="title" type="text" name="title" placeholder="Title" required>

            <label for="rating">IMDbRating</label>
            <input id="rating" type="number" step="0.1" min="1" max="10" name="rating" placeholder="Rating" required>

            <label for="year">Release Year</label>
            <input id="year" type="number" name="year" min="1800" placeholder="Year" required>

            <label for="plot">Plot</label>
            <textarea id="plot" name="plot" placeholder="Plot" required></textarea>

            <button type="submit">Submit</button>
        </form>

        <ul hx-get="/movies" hx-trigger="load" hx-swap="innerHTML" mustache-array-template="movies"> </ul>

        <template id="movies">
            {{ #data }}
            <li>
                <div>{{ title }} ({{ year }})</div>
                <div>Rating: {{ rating }} / 10</div>
                <div>{{ plot }}</div>
            </li>
            {{ /data }}
        </template>
    </div>
    <!-- <script>
        htmx.on("htmx:beforeRequest", function(evt) {
            console.log(evt);
        });
    </script> -->
</body>

</html>